# -csv
import os import csv import datetime class HebingCSV:     def __init__(self,inputfolder="f:\\input1\\",outputfolder="d:\\output1\\"):         self.inputfolder=inputfolder         self.outputfolder=outputfolder     def action(self):         startTime=datetime.datetime.now()#计时开始         print(u"开始处理...")         file_list = os.listdir(self.inputfolder)#获取目标文件夹下所有csv文件名称         file_list = [file_list]#将文件名存放在列表中         running = True         for file in file_list:             while running:                         if file[0][0:12] == file[1][0:12] and \                    file[0][0:12] == file[2][0:12] and \                    file[0][0:12] == file[3][0:12] and \                    file[0][0:12] == file[4][0:12] :#因为我要合并的最多有连续5个的名字前13位相同                                      self.csvappend(self.inputfolder+file[0],self.outputfolder+file[0])#写入以第一个文件名命名的新csv                     self.csvappend(self.inputfolder+file[1],self.outputfolder+file[0])#继续写入                     self.csvappend(self.inputfolder+file[2],self.outputfolder+file[0])                     self.csvappend(self.inputfolder+file[3],self.outputfolder+file[0])                     self.csvappend(self.inputfolder+file[4],self.outputfolder+file[0])                                         del(file[0:5])#在文件名列表中删除已写入的                     print('done1.0')#程序成功运行此循环一次的标记                     if len(file) &lt;= 5:#防止列表删除至最后几个时程序报错                         break                     continue                                                       if file[0][0:12] == file[1][0:12] and \                      file[0][0:12] == file[2][0:12] and \                      file[0][0:12] == file[3][0:12]:#因为我要合并的还有连续4个的名字前13位相同                                      self.csvappend(self.inputfolder+file[0],self.outputfolder+file[0])                     self.csvappend(self.inputfolder+file[1],self.outputfolder+file[0])                     self.csvappend(self.inputfolder+file[2],self.outputfolder+file[0])                     self.csvappend(self.inputfolder+file[3],self.outputfolder+file[0])                      del(file[0:4])                     print('done2.0')                     if len(file) &lt;= 4:                         break                     continue                                    else:                     running = False#结束循环             endTime=datetime.datetime.now()#计时结束             print(u"处理完成，耗时：%f秒"%(endTime-startTime).seconds)                                    def csvappend(self,inputfile,outputfile):#写入csv函数，使程序看起来简洁一些             with open(inputfile, 'rt') as csvfile:                 reader = csv.reader(csvfile)                  for row in reader:                     o=open(outputfile,"a", newline='')                     writer=csv.writer(o)                     writer.writerow(row)                                                                 if __name__=="__main__":     csvHebing=HebingCSV("f:\\input1\\","d:\\output1\\")#写入写出的文件夹     csvHebing.action()
